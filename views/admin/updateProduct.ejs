<%- include('_userheader') %>
<%- include('_header') %>

	
	
	<!-- sidebar -->
	<%- include('_sideBar') %>
	<!-- sidebar -->

	
	<!--================Login Box Area =================-->
	<section class="login_box_area section_gap">
		<div class="container">
			<%- include('_navBar') %>
			<div class="row">
				<div class="col-lg-4">
					<div class="container">
						<div class="row">
							<div class="col-lg-12">
								<img class="img-fluid" src="<%= products.image[0] %>" alt="">
								<p>Main Image &nbsp;
									<% if ( products.image[0]) { %>
										<a href="/delete-image/<%= products.image[0] %>/<%= products._id %>" style="text-decoration: none; color: red;" >Delete Image <i  class="fa fa-trash" aria-hidden="true" style="color: red;"></i></a></p>
									<% } %>
						   </div>
						   <div class="col-lg-4">
							<img class="img-fluid" src="<%= products.image[1] %>" alt="">
							<% if ( products.image[1]) { %>
								<a href="/delete-image/<%= products.image[1] %>/<%= products._id %>" style="text-decoration: none; color: red;" > <i  class="fa fa-trash" aria-hidden="true" style="color: red;"></i></a></p>
							<% } %>
					       </div>
						  
							
							<div class="col-lg-4">
								<img class="img-fluid" src="<%= products.image[2] %>" alt="">
								<% if ( products.image[2]) { %>
									<a href="/delete-image/<%= products.image[2] %>/<%= products._id %>" style="text-decoration: none; color: red;" >  <i  class="fa fa-trash" aria-hidden="true" style="color: red;"></i></a></p>
								<% } %>
						  </div>
						  <div class="col-lg-4">
							<img class="img-fluid" src="<%= products.image[3] %>" alt="">
							<% if ( products.image[3]) { %>
								<a href="/delete-image/<%= products.image[3] %>/<%= products._id %>" style="text-decoration: none; color: red;" >  <i  class="fa fa-trash" aria-hidden="true" style="color: red;"></i></a></p>
							<% } %>

					  </div>
							
						</div>
					</div>
					<!-- <div class="login_box_img">
						<img class="img-fluid" src="/assets/img/login.jpg" alt="">
						<div class="hover">
					<p>Enjoy our offers and privilege by registering on our websit and loggin in </p>
							<a class="primary-btn" href="registration.html">Create an Account</a>
						</div>
					</div> -->
				</div>
				
				<div class="col-lg-8">
					<div class="login_form_inner">
						<h3>Add New Product</h3>
						<form class="row login_form" action="/update-product/<%= products._id %>"  method="post" id="updateProduct" enctype="multipart/form-data" >
							<div class="col-md-12 form-group">
								<input type="text" class="form-control" id="addName" name="name" value="<%=products.name  %>" placeholder="Product Name" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Product Name'">
							</div>
							
							<div class="col-md-12 row form-group">
								<label class="col-md-5 mt-3 ml-2" for="addBrand">Choose the Brand:</label>
								<select class="col-md-6" name="addBrand" >
									<% brand.forEach(function(brand) { %>
									<option value="<%= brand._id %>" <% if (brand.name === products.brand.name ) {%>
										selected
										<% } %>>
										<%= brand.name %></option>
									
									<%});%>
						          </select>
							</div>
							<div class="col-md-12 row form-group">
								<label class="col-md-5 mt-3 ml-2" for="addCategory">Choose the Category:</label>
                                    <select class="col-md-6" name="addCategory" id="addCategory">
										<% category.forEach(function(category) { %>
                                      <option value="<%= category._id %>" <% if (category.name === products.category.name ) {%>
										selected
										<% } %>>
										<%= category.name %></option>
                                      <% }); %>
                                    </select>
							</div>
							<div class="col-md-12 form-group">
								<input type="tel" class="form-control" id="addStock" name="addStock" value="<%= products.stock %>" placeholder="Stock" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Stock'">
							</div>
                            <div class="col-md-12 form-group">
								<input type="text" class="form-control" id="addDescription" name="addDescription" value="<%=products.description  %>" placeholder="Product Description" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Product Description'">
							</div>
							<div class="col-md-12 form-group">
								<input onchange="return fileValidation()" type="file" multiple class="form-control" id="image" name="image" value="<% (brand).forEach(element => { %><%= element  %><% }) %>" placeholder="Image" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Image'">
							</div>
							
                            <div class="col-md-12 form-group">
								<input type="number" class="form-control" id="addPrice" name="addPrice" value="<%=products.price  %>" placeholder="Price" onfocus="this.placeholder = ''" onblur="this.placeholder = 'price'">
							</div>
							
							<div class="col-md-12 form-group mb-5">
								<button type="submit" value="submit" class="bg-transparent">Update Product</button>
								
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!--================End Login Box Area =================-->


	<script>
		function fileValidation() {
		   let fileInput =
			   document.getElementById('image');
			
		   let filePath = fileInput.value;
		
		   // Allowing file type
		   let allowedExtensions =
				   /(\.jpg|\.jpeg|\.png|\.gif)$/i;
			
		   if (!allowedExtensions.exec(filePath)) {
			   alert('Kindly select and valid Image');
			   fileInput.value = '';
			   return false;
		   }
		  
	   }
	 </script>
	
<%- include('_footer') %>

	<%- include('_userfooter') %>